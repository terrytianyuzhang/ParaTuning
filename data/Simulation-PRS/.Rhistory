#####
PRS_both_population[, is.case := as.numeric((PHENO1 == 2))]
PRS_both_population
#####
FDR_both_method <- data.table()
FDR_by_threshold <- data.table()
for(threshold in seq(-4, 4, length = 50)){
temp_table <- PRS_both_population[jls >= thr,
.(total_positive = .N,
true_positive = sum(is.case),
threshold = threshold),
by = population]
FDR_by_threshold <- rbind(FDR_by_threshold,
temp_table)
}
for(threshold in seq(-4, 4, length = 50)){
temp_table <- PRS_both_population[jls >= threshold,
.(total_positive = .N,
true_positive = sum(is.case),
threshold = threshold),
by = population]
FDR_by_threshold <- rbind(FDR_by_threshold,
temp_table)
}
FDR_by_threshold
FDR_by_threshold[, FDR:= 1-true_positive/total_positive]
FDR_by_threshold[, method:= 'JLssum']
FDR_by_threshold
FDR_both_method <- rbind(FDR_both_method, FDR_by_threshold)
#####
FDR_both_method <- data.table()
#####
FDR_by_threshold <- data.table()
for(threshold in seq(-4, 4, length = 50)){
temp_table <- PRS_both_population[jls >= threshold,
.(total_positive = .N,
true_positive = sum(is.case),
threshold = threshold),
by = population]
FDR_by_threshold <- rbind(FDR_by_threshold,
temp_table)
}
FDR_by_threshold[, FDR:= 1-true_positive/total_positive]
FDR_by_threshold[, method:= 'JLssum']
FDR_both_method <- rbind(FDR_both_method, FDR_by_threshold)
#####
FDR_by_threshold <- data.table()
for(threshold in seq(-4, 4, length = 50)){
temp_table <- PRS_both_population[ls.cis >= threshold,
.(total_positive = .N,
true_positive = sum(is.case),
threshold = threshold),
by = population]
FDR_by_threshold <- rbind(FDR_by_threshold,
temp_table)
}
FDR_by_threshold[, FDR:= 1-true_positive/total_positive]
FDR_by_threshold[, method:= 'Lassosum']
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(pop,'-',method)),
color = as.factor(paste0(pop,'-',method))),
data = FDR_both_method)+
theme_bw()+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#6D90AD","#ADC0ED",
"#B8689a","#F8A8Ca"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#6D90AD","#ADC0ED",
"#B8689a","#F8A8Ca"))
View(FDR_both_method)
#####
FDR_both_method <- data.table()
#####
FDR_by_threshold <- data.table()
for(threshold in seq(-4, 4, length = 50)){
temp_table <- PRS_both_population[jls >= threshold,
.(total_positive = .N,
true_positive = sum(is.case),
threshold = threshold),
by = population]
FDR_by_threshold <- rbind(FDR_by_threshold,
temp_table)
}
FDR_by_threshold[, FDR:= 1-true_positive/total_positive]
FDR_by_threshold[, method:= 'JLssum']
#####
FDR_both_method <- rbind(FDR_both_method, FDR_by_threshold)
#####
FDR_by_threshold <- data.table()
for(threshold in seq(-4, 4, length = 50)){
temp_table <- PRS_both_population[ls.cis >= threshold,
.(total_positive = .N,
true_positive = sum(is.case),
threshold = threshold),
by = population]
FDR_by_threshold <- rbind(FDR_by_threshold,
temp_table)
}
FDR_by_threshold[, FDR:= 1-true_positive/total_positive]
FDR_by_threshold[, method:= 'Lassosum']
#####
FDR_both_method <- rbind(FDR_both_method, FDR_by_threshold)
#####
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#6D90AD","#ADC0ED",
"#B8689a","#F8A8Ca"))
############get the false discovery rate plot
View(FDR_both_method)
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#6D90AD","#ADC0ED",
"#B8689a","#F8A8Ca"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#008779", "#f1b3a9",
"#0fc5e3", "#ffb919"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot(data = FDR_both_method)+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
geom_points(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method))))+
theme_bw()+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot(data = FDR_both_method)+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method))))+
theme_bw()+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot(data = FDR_both_method)+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
fill = as.factor(paste0(population,'-',method))))+
theme_bw()+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))+
scale_fill_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot(data = FDR_both_method)+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
theme_bw()+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))+
scale_fill_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot(data = FDR_both_method)+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
theme_bw()+
theme(legend = 'none')+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))+
scale_fill_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
?theme
ggplot(data = FDR_both_method)+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))))+
theme_bw()+
theme(legend.position = 'none')+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))+
scale_fill_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
theme(legend.position = 'none')+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))+
scale_fill_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))+
scale_fill_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
# xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
show.legend = FALSE,
data = FDR_both_method)+
# geom_line(aes(x = threshold, y = FDR,
#               group = as.factor(paste0(population,'-',method)),
#               color = as.factor(paste0(population,'-',method)),)
#           data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
# xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
View(FDR_both_method)
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
show.legend = FALSE,
data = FDR_both_method)+
geom_line(aes(x = threshold, y = total_positive,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method)),)
data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
# xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
show.legend = FALSE,
data = FDR_both_method)+
geom_line(aes(x = threshold, y = total_positive,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method)))
data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
# xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
show.legend = FALSE,
data = FDR_both_method)+
geom_line(aes(x = threshold, y = total_positive,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
# xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
show.legend = FALSE,
data = FDR_both_method)+
# geom_line(aes(x = threshold, y = total_positive,
#               group = as.factor(paste0(population,'-',method)),
#               color = as.factor(paste0(population,'-',method))),
#           data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
# xlim(c(-2, 2))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
show.legend = FALSE,
data = FDR_both_method)+
# geom_line(aes(x = threshold, y = total_positive,
#               group = as.factor(paste0(population,'-',method)),
#               color = as.factor(paste0(population,'-',method))),
#           data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
xlim(c(-1, 1))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
ggplot()+
geom_line(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
data = FDR_both_method)+
geom_point(aes(x = threshold, y = FDR,
group = as.factor(paste0(population,'-',method)),
shape = as.factor(paste0(population,'-',method)),
color = as.factor(paste0(population,'-',method))),
show.legend = FALSE,
data = FDR_both_method)+
# geom_line(aes(x = threshold, y = total_positive,
#               group = as.factor(paste0(population,'-',method)),
#               color = as.factor(paste0(population,'-',method))),
#           data = FDR_both_method)+
theme_bw()+
# theme(legend.position = 'none')+
# xlim(c(-1, 1))+
xlab('PGS threshold')+
scale_color_manual(name=" ",
# labels=
values=c("#d72631", "#a2d5c6",
"#077b8a", "#5c3c92"))
